<!DOCTYPE html>
<html xml:lang="ja" lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>HTML CAPTURE | BLACKFLAG</title>
<link rel="stylesheet" type="text/css" href="css/reset.css">
<link rel="stylesheet" type="text/css" href="css/common.css">

<style>
.preview {
	margin-top: 10px;
}
.preview img {
	max-width: 100%;
	height: auto;
	border: 1px solid #ccc;
}
.preview button {
	margin-top: 8px;
	padding: 6px 12px;
}
</style>
</head>

<body>
<h1>HTML CAPTURE</h1>

<dl>
	<dt>写真</dt>
	<dd>
		<div>
			<label><span>背面カメラ</span>
			<input type="file" capture="environment" accept="image/*" class="photo-capture">
			</label>
			<div class="preview"></div>
		</div>

		<div>
			<label><span>インカメラ</span>
			<input type="file" capture="user" accept="image/*" class="photo-capture">
			</label>
			<div class="preview"></div>
		</div>
	</dd>
</dl>

<small>Home <a href="https://sgn-test.github.io/">Back</a></small>

<script>
document.querySelectorAll('.photo-capture').forEach(input => {
	input.addEventListener('change', function(e) {
		const file = e.target.files[0];
		if (!file) return;

		const container = e.target.closest('div');
		const preview = container.querySelector('.preview');
		preview.innerHTML = '';

		// 画像表示
		const img = document.createElement('img');
		const url = URL.createObjectURL(file);
		img.src = url;
		preview.appendChild(img);

		// 保存ボタン
		const btn = document.createElement('button');
		btn.textContent = '保存';
		btn.addEventListener('click', () => {
			const a = document.createElement('a');
			a.href = url;
			a.download = 'photo_' + Date.now() + '.jpg';
			document.body.appendChild(a);
			a.click();
			document.body.removeChild(a);
		});
		preview.appendChild(btn);

		// メモリ解放
		img.onload = () => {
			URL.revokeObjectURL(url);
		};
	});
});
</script>

</body>
</html>
